<!DOCTYPE html>
<html lang="en" class="dark">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="csrf-token" content="<%= locals.csrfToken %>">
    <title><%= locals.title || locals.settings?.siteName || 'StatusSaaS' %></title>
    <link href="/css/output.css" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="/js/theme.js"></script>
    <%- locals.head %>
</head>
<body class="min-h-screen bg-background font-sans antialiased">
    <!-- Navigation -->
    <nav class="sticky top-6 z-50 mx-auto !max-w-[1400px] rounded-2xl bg-card !px-6 md:!px-9">
        <div>
            <div class="flex h-16 justify-between">
                <!-- Left section - Logo -->
                <div class="flex">
                    <div class="flex-shrink-0 flex items-center">
                        <a href="/" class="flex items-center space-x-2">
                            <% if (locals.settings?.logo) { %>
                                <img src="<%= locals.settings.logo %>" alt="<%= locals.settings?.siteName || 'Logo' %>" class="h-8 w-auto">
                            <% } %>
                            <span class="text-2xl font-semibold text-foreground"><%= locals.settings?.siteName || 'StatusSaaS' %></span>
                        </a>
                    </div>
                </div>

                <!-- Center section - Navigation links -->
                <div class="hidden sm:flex sm:items-center sm:justify-center sm:flex-1">
                    <div class="flex space-x-8">
                        <a href="/features" class="text-muted-foreground hover:text-foreground transition-colors duration-200">
                            Features
                        </a>
                        <a href="/pricing" class="text-muted-foreground hover:text-foreground transition-colors duration-200">
                            Pricing
                        </a>
                    </div>
                </div>

                <!-- Right section - Auth buttons -->
                <div class="flex items-center space-x-4">
                    <!-- Theme toggle -->
                    <button
                        type="button"
                        data-theme-toggle
                        class="inline-flex h-9 w-9 items-center justify-center rounded-md border bg-background hover:bg-accent hover:text-accent-foreground"
                    >
                        <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" data-theme-icon="sun" class="dark:hidden">
                            <circle cx="12" cy="12" r="4"></circle>
                            <path d="M12 2v2"></path>
                            <path d="M12 20v2"></path>
                            <path d="m4.93 4.93 1.41 1.41"></path>
                            <path d="m17.66 17.66 1.41 1.41"></path>
                            <path d="M2 12h2"></path>
                            <path d="M20 12h2"></path>
                            <path d="m6.34 17.66-1.41 1.41"></path>
                            <path d="m19.07 4.93-1.41 1.41"></path>
                        </svg>
                        <svg xmlns="http://www.w3.org/2000/svg" width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" data-theme-icon="moon" class="hidden dark:block">
                            <path d="M12 3a6 6 0 0 0 9 9 9 9 0 1 1-9-9Z"></path>
                        </svg>
                    </button>

                    <% if (locals.user) { %>
                        <div class="relative">
                            <button
                                type="button"
                                class="flex h-8 w-8 items-center justify-center rounded-full ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2"
                                id="user-menu-button"
                            >
                                <span class="sr-only">Open user menu</span>
                                <img
                                    class="h-8 w-8 rounded-full"
                                    src="<%= locals.user.avatar || 'https://ui-avatars.com/api/?name=' + encodeURIComponent(locals.user.name) %>"
                                    alt=""
                                >
                            </button>

                            <!-- Dropdown menu -->
                            <div
                                class="hidden absolute right-0 z-10 mt-2 w-56 origin-top-right rounded-md bg-popover text-popover-foreground shadow-md ring-1 ring-black ring-opacity-5 focus:outline-none"
                                role="menu"
                                id="user-menu"
                            >
                                <div class="border-b p-2">
                                    <p class="text-sm font-medium"><%= locals.user.name || 'User' %></p>
                                    <p class="text-sm text-muted-foreground truncate"><%= locals.user.email %></p>
                                </div>
                                <div class="p-1">
                                    <a
                                        href="/dashboard"
                                        class="relative flex cursor-pointer select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none transition-colors hover:bg-accent hover:text-accent-foreground focus:bg-accent focus:text-accent-foreground"
                                    >
                                        Dashboard
                                    </a>
                                    <a
                                        href="/settings"
                                        class="relative flex cursor-pointer select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none transition-colors hover:bg-accent hover:text-accent-foreground focus:bg-accent focus:text-accent-foreground"
                                    >
                                        Settings
                                    </a>
                                    <% if (locals.user.isAdmin) { %>
                                        <a
                                            href="/admin"
                                            class="relative flex cursor-pointer select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none transition-colors hover:bg-accent hover:text-accent-foreground focus:bg-accent focus:text-accent-foreground"
                                        >
                                            App Superadmin
                                        </a>
                                    <% } %>
                                    <form action="/auth/logout" method="POST">
                                        <button
                                            type="submit"
                                            class="relative flex w-full cursor-pointer select-none items-center rounded-sm px-2 py-1.5 text-sm outline-none transition-colors hover:bg-accent hover:text-accent-foreground focus:bg-accent focus:text-accent-foreground"
                                        >
                                            Logout
                                        </button>
                                    </form>
                                </div>
                            </div>
                        </div>
                    <% } else { %>
                        <a
                            href="/auth/register"
                            class="inline-flex items-center justify-center rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 border border-input bg-background hover:bg-accent hover:text-accent-foreground h-9 px-4 py-2"
                        >
                            Register
                        </a>
                        <a
                            href="/auth/login"
                            class="inline-flex items-center justify-center rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 bg-primary text-primary-foreground hover:bg-primary/90 h-9 px-4 py-2"
                        >
                            Login
                        </a>
                    <% } %>
                </div>
            </div>
        </div>
    </nav>

    <!-- Main content -->
    <main class="mx-auto max-w-7xl px-4 py-12 sm:px-6 lg:px-8">
        <%- locals.body %>
    </main>

    <!-- Footer -->
    <footer class="mt-6 border-t border-border">
        <div class="mx-auto max-w-7xl py-12 px-4 sm:px-6 lg:px-8">
            <div class="text-center text-sm text-muted-foreground">
                <p>&copy; <%= new Date().getFullYear() %> <%= locals.settings?.siteName || 'StatusSaaS' %>. All rights reserved.</p>
            </div>
        </div>
    </footer>

    <script>
        // User menu toggle
        document.addEventListener('DOMContentLoaded', function() {
            const userMenuButton = document.getElementById('user-menu-button');
            const userMenu = document.getElementById('user-menu');

            if (userMenuButton && userMenu) {
                userMenuButton.addEventListener('click', function(event) {
                    event.stopPropagation();
                    userMenu.classList.toggle('hidden');
                });

                // Close the menu when clicking outside
                document.addEventListener('click', function(event) {
                    if (!userMenuButton.contains(event.target) && !userMenu.contains(event.target)) {
                        userMenu.classList.add('hidden');
                    }
                });
            }
        });
    </script>
    <%- locals.scripts %>
</body>
</html> 